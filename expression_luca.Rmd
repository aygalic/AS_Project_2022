---
title: "Analysis of Expression Dataset"
author: "Luca"
date: '2022-03-28'
output: html_document
---


# INFORMATION ON THE DATASET
cancer_study_identifier: ccle_broad_2019
genetic_alteration_type: MRNA_EXPRESSION
datatype: Z-SCORE
stable_id: rna_seq_mrna_median_Zscores
profile_name: mRNA expression z-scores relative to diploid samples (RNA Seq RPKM)
profile_description: mRNA z-Scores (RNA Seq RPKM) compared to the expression distribution of each gene tumors that are diploid for this gene.
show_profile_in_analysis_tab: true
data_filename: data_mrna_seq_rpkm_zscores_ref_diploid_samples.txt

For mRNA and microRNA expression data, we typically compute the relative expression of an individual gene and tumor to the gene's expression distribution in a reference population. That reference population is either all tumors that are diploid for the gene in question, or, when available, normal adjacent tissue.

A z-score for a sample indicates the number of standard deviations away from the mean of expression in the reference. The formula is:

z = (expression in tumor sample - mean expression in reference sample) / standard deviation of expression in reference sample

## IMPORT DATA

```{r setup, include=FALSE}
#data_expression= read.delim(file.path("Dataset", "data_mrna_seq_rpkm_zscores_ref_diploid_samples.txt"), header = TRUE, comment.char = '#')

```

Professor said to consider  data_mrna_seq_rpkm.txt

```{r}
data_expression= read.delim(file.path("Dataset", "data_mrna_seq_rpkm.txt"), header = TRUE, comment.char = '#')

```

## PROBLEM 1: DUPLICATES 

```{r}
sum(duplicated(data_expression))
```

```{r}
duplicated_values <- duplicated(data_expression)
data_expression[duplicated_values,]
```
```{r include=FALSE}
library(dplyr)
```

```{r}
data_expression_clean <- distinct(data_expression, .keep_all=TRUE)
```

```{r}
sum(duplicated(data_expression_clean))
```

If i try to set rownames, i get an error:  

```{r}
rownames(data_expression_clean)<-data_expression_clean$Hugo_Symbol
data_expression_clean$Hugo_Symbol <- NULL
```
I have multiple analysis for the same gene.

```{r}
sum(duplicated(data_expression_clean$Hugo_Symbol))
```

```{r}
repetitions <- data_expression_clean[duplicated(data_expression_clean$Hugo_Symbol),]
```

```{r}
hist(table(repetitions$Hugo_Symbol))
```

After eliminating the identical rows (where every term is the same) we obtain 1678 problematic rows, i.e. having the same identifier (Hugo-symbol) for 206 genes. I note that the Y_RNA gene is repeated 681 times while the others are repeated a few times (about 1-4 repetitions).

## PROBLEM 2: MISSING VALUES (0)

The dataset seems to be complete, or rather, there are no Na values. However, I notice that there are many 0's, which makes me think that 0 has been used to indicate a missing value. 

```{r}
data_expression_clean[data_expression_clean == 0] <- NA
```

```{r}
library(naniar)
```


```{r}
temp = data_expression_clean 
miss_var_summary(temp) #by cell
miss_case_summary(temp) #by gene
miss_var_table(temp) #by cell ordinati da quanti mancano
miss_case_table(temp) #By gene

sum(is.na(temp))

vis_miss(temp)
gg_miss_var(temp) #by cell
gg_miss_case(temp) #by drugs
```



```{r}
#Renaming rows
#rownames(data_expression_clean)<-data_expression_clean$Hugo_Symbol
#data_expression_clean$Hugo_Symbol <- NULL
```

## THINGS TO DO 

1. Selection of data to consider, removing the NA and filling them

How to fill them? (asked to professor) A mean value or the median might be fine, in this case I would first calculate the mean/median without considering NA to merge the duplicates and then think about the remaining NA.
Another approach is to remove everything that is duplicated, but we have to evaluate which alternative to take depending on the numbers we have.
Same for genes with NA.


2. Do an heatmap (of the selected data set and the other one with the removed values: check if there are some missing relationships)

3. PCA on 3 components (on normalized data/and not normalized data)

then, we plot the components in spaces and see if there are some clusters

Look at the dataset of expression and do pca on that( same methodology of before)

rmka pca will be totally black with some red points if not normalized

